{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { url } from \"./api\";\nimport jwtDecode from \"jwt-decode\";\nconst initialState = {\n  token: localStorage.getItem(\"token\"),\n  //check local storage for token, buitl in JS object\n  name: \"\",\n  email: \"\",\n  _id: \"\",\n  registerStatus: \"\",\n  //pending, fullfilled, or reject\n  registerError: \"\",\n  loginStatus: \"\",\n  loginError: \"\",\n  userLoaded: false\n}; //action creator --> performs http request to backend, register user, get back token, then should be avaialble to action.payload, in case error you also add to pay;oad\n\nexport const registerUser = createAsyncThunk(\"auth/registerUser\", async (values, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n\n  try {\n    //handle error, http request a call to backend\n    const token = await axios.post(`${url}/register`, {\n      name: values.name,\n      email: values.email,\n      password: values.password\n    });\n    localStorage.setItem(\"token\", token.data);\n    return token.data;\n  } catch (err) {\n    console.log(err.response.data);\n    return rejectWithValue(err.response.data);\n  }\n});\nconst authReducer = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    loadUser(state, action) {\n      const token = state.token; //state has token bc can get from local storage\n\n      if (token) {\n        const user = jwtDecode(token);\n        return { ...state,\n          token,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          userLoaded: true\n        };\n      }\n    },\n\n    logoutUser(state, action) {\n      localStorage.removeItem(\"token\");\n      return { ...state,\n        token: \"\",\n        name: \"\",\n        email: \"\",\n        _id: \"\",\n        registerStatus: \"\",\n        //pending, fullfilled, or reject\n        registerError: \"\",\n        loginStatus: \"\",\n        loginError: \"\",\n        userLoaded: false\n      };\n    }\n\n  },\n  //we will be creating reducer and action will automatically created by redux toolkit\n  extraReducers: builder => {\n    builder.addCase(registerUser.pending, (state, action) => {\n      return { ...state,\n        registerStatus: \"pending\"\n      };\n    });\n    builder.addCase(registerUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return { ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          registerStatus: \"success\"\n        };\n      } else return state;\n    });\n    builder.addCase(registerUser.rejected, (state, action) => {\n      return { ...state,\n        registerStatus: \"rejected\",\n        registerError: action.payload\n      };\n    });\n  }\n} //accepting object\n);\nexport const {\n  loadUser,\n  logoutUser\n} = authSlice.actions;\nexport default authReducer.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","url","jwtDecode","initialState","token","localStorage","getItem","name","email","_id","registerStatus","registerError","loginStatus","loginError","userLoaded","registerUser","values","rejectWithValue","post","password","setItem","data","err","console","log","response","authReducer","reducers","loadUser","state","action","user","logoutUser","removeItem","extraReducers","builder","addCase","pending","fulfilled","payload","rejected","authSlice","actions","reducer"],"sources":["/Users/lilosivert/Downloads/Code/React-Development/Online-Shop/Front-End/src/features/authSlice.js"],"sourcesContent":["import {createSlice, createAsyncThunk} from \"@reduxjs/toolkit\";\nimport axios from \"axios\"\nimport { url } from \"./api\";\nimport jwtDecode from \"jwt-decode\"\n\nconst initialState = {\n    token: localStorage.getItem(\"token\"),//check local storage for token, buitl in JS object\n    name: \"\",\n    email: \"\",\n    _id: \"\",\n    registerStatus: \"\",//pending, fullfilled, or reject\n    registerError: \"\",\n    loginStatus: \"\",\n    loginError: \"\",\n    userLoaded: false,\n};\n\n//action creator --> performs http request to backend, register user, get back token, then should be avaialble to action.payload, in case error you also add to pay;oad\nexport const registerUser = createAsyncThunk(\n    \"auth/registerUser\",\n    async (values, {rejectWithValue}) => {\n        try{//handle error, http request a call to backend\n            const token = await axios.post(`${url}/register`, {\n                name: values.name,\n                email: values.email,\n                password: values.password,\n            });\n\n            localStorage.setItem(\"token\", token.data);\n\n            return token.data;\n        }\n        catch(err) {\n            console.log(err.response.data);\n            return rejectWithValue(err.response.data);\n        }\n\n    }\n)\n\nconst authReducer = createSlice(\n    {\n        name: \"auth\",\n        initialState,\n        reducers: {\n            loadUser(state, action){\n                const token = state.token //state has token bc can get from local storage\n\n                if(token){\n                    const user = jwtDecode(token)\n                    return {\n                        ...state,\n                        token,\n                        name: user.name,\n                        email: user.email,\n                        _id: user._id,\n                        userLoaded: true,\n                    };\n                }\n            },\n            logoutUser(state, action){\n                localStorage.removeItem(\"token\")\n\n                return {\n                    ...state,\n                    token: \"\",\n                    name: \"\",\n                    email: \"\",\n                    _id: \"\",\n                    registerStatus: \"\",//pending, fullfilled, or reject\n                    registerError: \"\",\n                    loginStatus: \"\",\n                    loginError: \"\",\n                    userLoaded: false,\n                };\n            },\n        }, //we will be creating reducer and action will automatically created by redux toolkit\n        extraReducers: (builder) => {\n            builder.addCase(registerUser.pending, (state, action) => {\n                return { ...state, registerStatus: \"pending\"};\n            });\n            builder.addCase(registerUser.fulfilled, (state, action) => {\n                if(action.payload){\n                    const user = jwtDecode(action.payload);\n\n                    return{\n                        ...state,\n                        token: action.payload,\n                        name: user.name,\n                        email: user.email,\n                        _id: user._id,\n                        registerStatus: \"success\"\n                    };\n                }\n                else return state;\n            });\n            builder.addCase(registerUser.rejected, (state, action) => {\n                return {\n                    ...state,\n                    registerStatus: \"rejected\",\n                    registerError: action.payload\n                };\n            });\n        },\n    }//accepting object\n);\n\nexport const {loadUser, logoutUser} = authSlice.actions\n\nexport default authReducer.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}