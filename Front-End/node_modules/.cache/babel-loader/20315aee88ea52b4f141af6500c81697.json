{"ast":null,"code":"import _objectSpread from\"/Users/lilosivert/Downloads/Code/React-Development/Online-Shop/Front-End/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/lilosivert/Downloads/Code/React-Development/Online-Shop/Front-End/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/lilosivert/Downloads/Code/React-Development/Online-Shop/Front-End/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createSlice,createAsyncThunk}from\"@reduxjs/toolkit\";import axios from\"axios\";import{url,setHeaders}from\"./api\";import jwtDecode from\"jwt-decode\";var initialState={token:localStorage.getItem(\"token\"),//check local storage for token, buitl in JS object\nname:\"\",email:\"\",_id:\"\",registerStatus:\"\",//pending, fullfilled, or reject\nregisterError:\"\",loginStatus:\"\",loginError:\"\",userLoaded:false};//action creator --> performs http request to backend, register user, get back token, then should be avaialble to action.payload, in case error you also add to pay;oad\nexport var registerUser=createAsyncThunk(\"auth/registerUser\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values,_ref){var rejectWithValue,token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:rejectWithValue=_ref.rejectWithValue;_context.prev=1;_context.next=4;return axios.post(\"\".concat(url,\"/register\"),{name:values.name,email:values.email,password:values.password});case 4:token=_context.sent;localStorage.setItem(\"token\",token.data);return _context.abrupt(\"return\",token.data);case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.log(_context.t0.response.data);return _context.abrupt(\"return\",rejectWithValue(_context.t0.response.data));case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());export var loginUser=createAsyncThunk(\"auth/loginUser\",/*#__PURE__*/ //name is for dispatched action\nfunction(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(values,_ref3){var rejectWithValue,token;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:rejectWithValue=_ref3.rejectWithValue;_context2.prev=1;_context2.next=4;return axios.post(\"\".concat(url,\"/login\"),{//<-- http request \nemail:values.email,password:values.password});case 4:token=_context2.sent;localStorage.setItem(\"token\",token.data);return _context2.abrupt(\"return\",token.data);case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0.response);return _context2.abrupt(\"return\",rejectWithValue(_context2.t0.response.data));case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}());export var getUser=createAsyncThunk(\"auth/getUser\",/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(id,_ref5){var rejectWithValue,token;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:rejectWithValue=_ref5.rejectWithValue;_context3.prev=1;_context3.next=4;return axios.get(\"\".concat(url,\"/user/\").concat(id),setHeaders());case 4:token=_context3.sent;localStorage.setItem(\"token\",token.data);return _context3.abrupt(\"return\",token.data);case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0.response);return _context3.abrupt(\"return\",rejectWithValue(_context3.t0.response.data));case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function(_x5,_x6){return _ref6.apply(this,arguments);};}());var authSlice=createSlice({name:\"auth\",initialState:initialState,reducers:{loadUser:function loadUser(state,action){var token=state.token;//state has token bc can get from local storage\nif(token){var user=jwtDecode(token);return _objectSpread(_objectSpread({},state),{},{token:token,name:user.name,email:user.email,_id:user._id,userLoaded:true});}else return _objectSpread(_objectSpread({},state),{},{userLoaded:true});},logoutUser:function logoutUser(state,action){localStorage.removeItem(\"token\");return _objectSpread(_objectSpread({},state),{},{token:\"\",name:\"\",email:\"\",_id:\"\",registerStatus:\"\",//pending, fullfilled, or reject\nregisterError:\"\",loginStatus:\"\",loginError:\"\",userLoaded:false});}},//we will be creating reducer and action will automatically created by redux toolkit\nextraReducers:function extraReducers(builder){builder.addCase(registerUser.pending,function(state,action){return _objectSpread(_objectSpread({},state),{},{registerStatus:\"pending\"});});builder.addCase(registerUser.fulfilled,function(state,action){if(action.payload){var user=jwtDecode(action.payload);return _objectSpread(_objectSpread({},state),{},{token:action.payload,name:user.name,email:user.email,_id:user._id,registerStatus:\"success\"});}else return state;});builder.addCase(registerUser.rejected,function(state,action){return _objectSpread(_objectSpread({},state),{},{registerStatus:\"rejected\",registerError:action.payload});});builder.addCase(loginUser.pending,function(state,action){return _objectSpread(_objectSpread({},state),{},{registerStatus:\"pending\"});});builder.addCase(loginUser.fulfilled,function(state,action){if(action.payload){var user=jwtDecode(action.payload);return _objectSpread(_objectSpread({},state),{},{token:action.payload,name:user.name,email:user.email,_id:user._id,registerStatus:\"success\"});}else return state;});builder.addCase(loginUser.rejected,function(state,action){return _objectSpread(_objectSpread({},state),{},{loginStatus:\"rejected\",loginError:action.payload});});builder.addCase(getUser.pending,function(state,action){return _objectSpread(_objectSpread({},state),{},{getUserStatus:\"pending\"});});builder.addCase(getUser.fulfilled,function(state,action){if(action.payload){var user=jwtDecode(action.payload);//i think the action payload generates token\nreturn _objectSpread(_objectSpread({},state),{},{token:action.payload,name:user.name,email:user.email,_id:user._id,getUserStatus:\"success\"});}else return state;});builder.addCase(getUser.rejected,function(state,action){return _objectSpread(_objectSpread({},state),{},{getUserStatus:\"rejected\",getUserError:action.payload});});}}//accepting object\n);var _authSlice$actions=authSlice.actions,loadUser=_authSlice$actions.loadUser,logoutUser=_authSlice$actions.logoutUser;export{loadUser,logoutUser};export default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","url","setHeaders","jwtDecode","initialState","token","localStorage","getItem","name","email","_id","registerStatus","registerError","loginStatus","loginError","userLoaded","registerUser","values","rejectWithValue","post","password","setItem","data","console","log","response","loginUser","getUser","id","get","authSlice","reducers","loadUser","state","action","user","logoutUser","removeItem","extraReducers","builder","addCase","pending","fulfilled","payload","rejected","getUserStatus","getUserError","actions","reducer"],"sources":["/Users/lilosivert/Downloads/Code/React-Development/Online-Shop/Front-End/src/features/authSlice.js"],"sourcesContent":["import {createSlice, createAsyncThunk} from \"@reduxjs/toolkit\";\nimport axios from \"axios\"\nimport { url, setHeaders } from \"./api\";\nimport jwtDecode from \"jwt-decode\"\n\nconst initialState = {\n    token: localStorage.getItem(\"token\"),//check local storage for token, buitl in JS object\n    name: \"\",\n    email: \"\",\n    _id: \"\",\n    registerStatus: \"\",//pending, fullfilled, or reject\n    registerError: \"\",\n    loginStatus: \"\",\n    loginError: \"\",\n    userLoaded: false,\n};\n\n//action creator --> performs http request to backend, register user, get back token, then should be avaialble to action.payload, in case error you also add to pay;oad\nexport const registerUser = createAsyncThunk(\n    \"auth/registerUser\",\n    async (values, {rejectWithValue}) => {\n        try{//handle error, http request a call to backend\n            const token = await axios.post(`${url}/register`, {\n                name: values.name,\n                email: values.email,\n                password: values.password,\n            });\n\n            localStorage.setItem(\"token\", token.data);\n\n            return token.data;\n        }\n        catch(err) {\n            console.log(err.response.data);\n            return rejectWithValue(err.response.data);\n        }\n\n    }\n);\n\nexport const loginUser = createAsyncThunk(\n    \"auth/loginUser\", //name is for dispatched action\n    async (values, {rejectWithValue}) => {\n        try{//handle error, http request a call to backend \n            const token = await axios.post(`${url}/login`, { //<-- http request \n                email: values.email,\n                password: values.password,\n            });\n\n            localStorage.setItem(\"token\", token.data);\n\n            return token.data;\n        }\n        catch(err) {\n            console.log(err.response);\n            return rejectWithValue(err.response.data);\n        }\n\n    }\n);\n\nexport const getUser = createAsyncThunk(\n    \"auth/getUser\",\n    async (id, { rejectWithValue }) => {\n      try {\n        const token = await axios.get(`${url}/user/${id}`, setHeaders());\n  \n        localStorage.setItem(\"token\", token.data);\n  \n        return token.data;\n      } catch (error) {\n        console.log(error.response);\n        return rejectWithValue(error.response.data);\n      }\n    }\n  );\n\n\nconst authSlice = createSlice(\n    {\n        name: \"auth\",\n        initialState,\n        reducers: {\n            loadUser(state, action){\n                const token = state.token //state has token bc can get from local storage\n\n                if(token){\n                    const user = jwtDecode(token)\n                    return {\n                        ...state,\n                        token,\n                        name: user.name,\n                        email: user.email,\n                        _id: user._id,\n                        userLoaded: true,\n                    };\n                } else return {...state, userLoaded: true}\n            },\n            logoutUser(state, action){\n                localStorage.removeItem(\"token\")\n\n                return {\n                    ...state,\n                    token: \"\",\n                    name: \"\",\n                    email: \"\",\n                    _id: \"\",\n                    registerStatus: \"\",//pending, fullfilled, or reject\n                    registerError: \"\",\n                    loginStatus: \"\",\n                    loginError: \"\",\n                    userLoaded: false,\n                };\n            },\n        }, //we will be creating reducer and action will automatically created by redux toolkit\n        extraReducers: (builder) => {\n            builder.addCase(registerUser.pending, (state, action) => {\n                return { ...state, registerStatus: \"pending\"};\n            });\n            builder.addCase(registerUser.fulfilled, (state, action) => {\n                if(action.payload){\n                    const user = jwtDecode(action.payload);\n\n                    return{\n                        ...state,\n                        token: action.payload,\n                        name: user.name,\n                        email: user.email,\n                        _id: user._id,\n                        registerStatus: \"success\"\n                    };\n                }\n                else return state;\n            });\n            builder.addCase(registerUser.rejected, (state, action) => {\n                return {\n                    ...state,\n                    registerStatus: \"rejected\",\n                    registerError: action.payload\n                };\n            });\n\n\n            builder.addCase(loginUser.pending, (state, action) => {\n                return { ...state, registerStatus: \"pending\"};\n            });\n            builder.addCase(loginUser.fulfilled, (state, action) => {\n                if(action.payload){\n                    const user = jwtDecode(action.payload);\n\n                    return{\n                        ...state,\n                        token: action.payload,\n                        name: user.name,\n                        email: user.email,\n                        _id: user._id,\n                        registerStatus: \"success\"\n                    };\n                }\n                else return state;\n            });\n            builder.addCase(loginUser.rejected, (state, action) => {\n                return {\n                    ...state,\n                    loginStatus: \"rejected\",\n                    loginError: action.payload\n                };\n            });\n\n\n            builder.addCase(getUser.pending, (state,action) => {\n                return {\n                    ...state,\n                    getUserStatus: \"pending\",\n                };\n            });\n            builder.addCase(getUser.fulfilled, (state, action) => {\n                if(action.payload) {\n                    const user = jwtDecode(action.payload) //i think the action payload generates token\n                    return {\n                        ...state,\n                        token: action.payload,\n                        name: user.name,\n                        email: user.email,\n                        _id: user._id,\n                        getUserStatus: \"success\",\n                    };\n                } else return state;\n            });\n            builder.addCase(getUser.rejected, (state,action) => {\n                return {\n                    ...state,\n                    getUserStatus: \"rejected\",\n                    getUserError: action.payload,\n                };\n            });\n        },\n    }//accepting object\n);\n\nexport const {loadUser, logoutUser} = authSlice.actions\n\nexport default authSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}